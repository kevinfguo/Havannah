angular.module("myApp",[]).factory("gameLogic",function(){function a(a){var b,c;for(b=0;15>b;++b)for(c=q[b][0];c<q[b][1];++c)if(""===a[b][c])return!1;return!0}function b(b,e,f,g){if(void 0===b&&(b=d()),""!==b[e][f])throw new Error("One can only make a move in an empty position!");var h=angular.copy(b);h[e][f]=0===g?"R":"B";var i,j=c(h,e,f,g);return i=""!==j||a(h)?{endMatch:{endMatchScores:"R"===j?[1,0]:"B"===j?[0,1]:[0,0]}}:{setTurn:{turnIndex:1-g}},[i,{set:{key:"board",value:h}},{set:{key:"delta",value:{row:e,col:f}}}]}function c(a,b,c){if(1==f(a,b,c)||1==g(a,b,c)||1==h(a,b,c)){if("B"==a[b][c])return"B";if("R"==a[b][c])return"R"}return""}function d(){var a,b,c=new Array(14);for(a=0;15>a;++a)for(c[a]=new Array(14),b=q[a][0];b<q[a][1];++b)c[a][b]="";return c}function e(a){var c=a.move,d=a.turnIndexBeforeMove,e=a.stateBeforeMove;try{var f=c[2].set.value,g=f.row,h=f.col,i=e.board,j=b(i,g,h,d);if(console.log(j),!o(g,h))return!1;if(!angular.equals(c,j))return console.log(j,"move not equal to exp move"),!1}catch(k){return console.log("exception"),!1}return!0}function f(a,b,c){var d=l(a,b,c),e=0;for(var f in d){var g=f.split(",");for(k=0;k<7;k++)angular.equals(g,x[k])&&e++}return e>1?!0:!1}function g(a,b,c){var d=l(a,b,c),e=0,f=0,g=0,h=0,i=0,j=0,m=0;for(var n in d){var o=n.split(",");for(k=0;k<6;k++)angular.equals(o,r[k])&&(e=1),angular.equals(o,s[k])&&(f=1),angular.equals(o,t[k])&&(g=1),angular.equals(o,u[k])&&(h=1),angular.equals(o,v[k])&&(i=1),angular.equals(o,w[k])&&(j=1)}return m=e+f+g+h+i+j,3==m?!0:!1}function h(a,b,c){console.log(a);var d=a[b][c],e=m(a,b,c),f=0;if(e.length>1&&2==e.length)for(g in m(a,e[0][0],e[0][1]))if(g[0]==e[1][0]&&g[1]==e[1][1]){f=1;break}if(1==f)return!1;e=n(a,b,c,d);console.log(e);for(var g=0;g<e.length;g++){var h=angular.copy(a);h[b][c]="Z";var i;f=0;var j=[];for(j.push(e[g]);0!=j.length;){for(i=j.pop(),h[i[0]][i[1]]="Z",k=0;k<6;k++){if(i[0]==r[k][0]&&i[1]==r[k][1]){f=1;break}if(i[0]==s[k][0]&&i[1]==s[k][1]){f=1;break}if(i[0]==t[k][0]&&i[1]==t[k][1]){f=1;break}if(i[0]==u[k][0]&&i[1]==u[k][1]){f=1;break}if(i[0]==v[k][0]&&i[1]==v[k][1]){f=1;break}if(i[0]==w[k][0]&&i[1]==w[k][1]){f=1;break}if(i[0]==x[k][0]&&i[1]==x[k][1]){f=1;break}}j=j.concat(n(h,i[0],i[1],d))}if(0==f)return console.log("trueee"),!0}return console.log("reached here"),!1}function i(a,b,c){var d=j(a,b,c),e=l(a,b,c),f=[],g=0;for(var h in d)f[h]=0;for(var h in d){var i=0,k=d[h],n=m(a,k[0],k[1],color);for(nbr_cell in n)n[nbr_cell]in e==!0&&(i++,2==i&&(f[h]=1))}for(var h in f){if(0===f[h])return!1;if(1===f[h]){var o=0,k=d[h],n=m(a,k[0],k[1]);for(nbr_cell in n)if(o++,o==d.length-1)return!1}}var d=l(a,b,c),n=m(a,b,c),g=0,i=0;for(var h in d)g++;if(g>5)for(var h in d){var p,q=0;for(nbr_cell in n)if(angular.equals(d[h],n[nbr_cell])){var r=n[nbr_cell],s=m(a,r[0],r[1]);for(ind in s)angular.equals(s[ind],p)&&q++;p=n[nbr_cell]}if(q>n.length-2)return!1}return!0}function j(a,b,c){var d=[];d.push([b,c]);var e=[];e[[b,c]]=[-1,-1];var f=[],g=[];for(g.push([b,c]);d.length>0;){var h=d.shift(),i=m(a,h[0],h[1]);for(var j in i)i[j]in e==!1&&(f[i[j]]=1,d.push(i[j]),e[i[j]]=h,g.push(i[j]))}return g}function l(a,b,c){var d=[];d.push([b,c]);var e=[];for(e[[b,c]]=[[b],[c]];d.length>0;){var f=d.shift(),g=m(a,f[0],f[1]);for(var h in g)g[h]in e==0&&(d.push(g[h]),e[g[h]]=g[h])}return e}function m(a,b,c){var d=[];return o(b-1,c)&&""!=a[b-1][c]&&a[b-1][c]===a[b][c]&&d.push([b-1,c]),o(b-1,c-1)&&""!=a[b-1][c-1]&&a[b-1][c-1]===a[b][c]&&d.push([b-1,c-1]),o(b,c-1)&&""!=a[b][c-1]&&a[b][c-1]==a[b][c]&&d.push([b,c-1]),o(b,c+1)&&""!=a[b][c+1]&&a[b][c+1]==a[b][c]&&d.push([b,c+1]),o(b+1,c+1)&&""!=a[b+1][c+1]&&a[b+1][c+1]==a[b][c]&&d.push([b+1,c+1]),o(b+1,c)&&""!=a[b+1][c]&&a[b+1][c]==a[b][c]&&d.push([b+1,c]),d}function n(a,b,c,d){var e=[];return o(b-1,c)&&"Z"!=a[b-1][c]&&a[b-1][c]!=d&&e.push([b-1,c]),o(b-1,c-1)&&"Z"!=a[b-1][c-1]&&a[b-1][c-1]!=d&&e.push([b-1,c-1]),o(b,c-1)&&"Z"!=a[b][c-1]&&a[b][c-1]!=d&&e.push([b,c-1]),o(b,c+1)&&"Z"!=a[b][c+1]&&a[b][c+1]!=d&&e.push([b,c+1]),o(b+1,c+1)&&"Z"!=a[b+1][c+1]&&a[b+1][c+1]!=d&&e.push([b+1,c+1]),o(b+1,c)&&"Z"!=a[b+1][c]&&a[b+1][c]!=d&&e.push([b+1,c]),e}function o(a,b){return a>-1&&15>a&&b>-1&&15>b&&b>q[a][0]-1&&b<q[a][1]?!0:!1}function p(a,c){var d,e,f=[];for(d=0;15>d;++d)for(e=q[d][0];e<q[d][1];++e)try{f.push(b(a,d,e,c))}catch(g){}return f}Array.prototype.contains=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return!0;return!1};var q=[[0,8],[0,9],[0,10],[0,11],[0,12],[0,13],[0,14],[0,15],[1,15],[2,15],[3,15],[4,15],[5,15],[6,15],[7,15]],r=[["0","1"],["0","2"],["0","3"],["0","4"],["0","5"],["0","6"]],s=[["1","8"],["2","9"],["3","10"],["4","11"],["5","12"],["6","13"]],t=[["8","14"],["9","14"],["10","14"],["11","14"],["12","14"],["13","14"]],u=[["14","8"],["14","9"],["14","10"],["14","11"],["14","12"],["14","13"]],v=[["8","1"],["9","2"],["10","3"],["11","4"],["12","5"],["13","6"]],w=[["1","0"],["2","0"],["3","0"],["4","0"],["5","0"],["6","0"]],x=[["0","0"],["0","7"],["7","14"],["14","14"],["14","7"],["7","0"]];return{getPossibleMoves:p,setBoard:d,createMove:b,isMoveOk:e,isTie:a,isInsideBoard:o,getConnectedPath:l,getConnectedPathForRing:j,getNeighborsWithSameColor:m,getBridgeWin:f,getForkWin:g,getRingWin:i,getWinner:c}}),angular.module("myApp").controller("Ctrl",["$scope","$rootScope","$log","$timeout","gameService","stateService","gameLogic","aiService","resizeGameAreaService",function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b,c){var d=b-u.offsetLeft,e=c-u.offsetTop;if(console.log(d,e,b,c,u.clientWidth,u.clientHeight),0>d||0>e||d>=u.clientWidth||e>=u.clientHeight)return void(r.style.display="none");var f=[[0,8],[0,9],[0,10],[0,11],[0,12],[0,13],[0,14],[0,15],[1,15],[2,15],[3,15],[4,15],[5,15],[6,15],[7,15]];r.style.display="inline";var g=Math.floor(v*e/u.clientHeight),h=Math.floor(w*d/u.clientWidth),i=k(g,h),j=n(g,h);console.log(j,g,h),t.setAttribute("x1",j.x),t.setAttribute("x2",j.x),s.setAttribute("y1",j.y),s.setAttribute("y2",j.y);var l=(m(g,h),"rotate(27.5 "+Math.floor(j.x)+" "+Math.floor(j.y)+")");t.setAttribute("transform",l);m(g,h);g>-1&&15>g&&(i>f[g][0]-1&&i<f[g][1]||(r.style.display="none")),("touchend"===a||"touchcancel"===a||"touchleave"===a||"mouseup"===a)&&(r.style.display="none",q(g,i))}function k(a,b){var c;return(0==a||1==a)&&(c=b-3),(2==a||3==a)&&(c=b-2),(4==a||5==a)&&(c=b-1),(6==a||7==a)&&(c=b),(8==a||9==a)&&(c=b+1),(10==a||11==a)&&(c=b+2),(12==a||13==a)&&(c=b+3),14==a&&(c=b+4),c}function l(){return{width:v%2==0?u.clientWidth/w-w*x/2:u.clientWidth/w,height:v%2==0?u.clientHeight/v-v*y/2:u.clientHeight/v}}function m(a,b){var c=l();return{top:a*c.height,left:b*c.width}}function n(a,b){var c,d=l();return c=a%2===1?b*d.width+d.width/2:b*d.width+d.width,{x:c,y:a*d.height+d.height/2}}function o(){e.makeMove(h.createComputerMove(a.board,a.turnIndex,{millisecondsLimit:1e3}))}function p(b){a.board=b.stateAfterMove.board;b.move;void 0===a.board&&(a.board=g.setBoard()),a.isYourTurn=b.turnIndexAfterMove>=0&&b.yourPlayerIndex===b.turnIndexAfterMove,a.turnIndex=b.turnIndexAfterMove,a.isYourTurn&&""===b.playersInfo[b.yourPlayerIndex].playerId&&(console.log("computer turn"),a.isYourTurn=!1,d(o,500))}function q(d,e){b.$apply(function(){var b="Dragged to "+d+"x"+e;c.info(b),a.msg=b,a.cellClicked(d,e)})}i.setWidthToHeight(1),a.numbersTo=function(a,b){for(var c=[],d=a;b>d;d++)c[d]=d;return c},a.getStyle=function(b,c){var d=a.board[b][c];return"R"===d?{"-webkit-animation":"moveAnimation 2s",animation:"moveAnimation 2s"}:"B"===d?{"-webkit-animation":"moveAnimation 2s",animation:"moveAnimation 2s"}:{}};var r=document.getElementById("draggingLines"),s=document.getElementById("horizontalDraggingLine"),t=document.getElementById("verticalDraggingLine"),u=document.getElementById("gameArea"),v=15,w=15;window.handleDragEvent=j,a.cellClicked=function(b,d){if(c.info(["Clicked on cell:",b,d]),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(a.isYourTurn)try{var f=g.createMove(a.board,b,d,a.turnIndex);a.isYourTurn=!1,e.makeMove(f)}catch(h){return void c.info(["Cell is already full in position:",b,d,h])}},a.shouldShowImage=function(b,c){var d=a.board[b][c];return""!==d},a.isPieceR=function(b,c){return"R"===a.board[b][c]},a.isPieceB=function(b,c){return"B"===a.board[b][c]},a.getImageSrc=function(b,c){var d=a.board[b][c];return"R"===d?"imgs/P.png":"B"===d?"imgs/B.png":""},a.shouldSlowlyAppear=function(b,c){return void 0!==a.delta&&a.delta.row===b&&a.delta.col===c},e.setGame({gameDeveloperEmail:"sm5119@nyu.edu",minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:g.isMoveOk,updateUI:p})}]),angular.module("myApp").factory("aiService",["alphaBetaService","gameLogic",function(a,b){"use strict";function c(b,c,g){return a.alphaBetaDecision([null,{set:{key:"board",value:b}}],c,e,d,"?debug"===window.location.search?f:null,g)}function d(a){if(a[0].endMatch){var b=a[0].endMatch.endMatchScores;return b[0]>b[1]?Number.POSITIVE_INFINITY:b[0]<b[1]?Number.NEGATIVE_INFINITY:0}return 0}function e(a,c){return b.getPossibleMoves(a[1].set.value,c)}function f(a){return"\n"+a[1].set.value.join("\n")+"\n"}return{createComputerMove:c}}]);
//# sourceMappingURL=everything.min.js.map